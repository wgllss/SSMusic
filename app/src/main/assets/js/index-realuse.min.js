var showHideUI=function(e){function t(t,n){n&&n(),e.$("#"+t).show()}function n(t,n){e.$("#"+t).hide(),n&&n()}return{show:t,hide:n}}(Kg),r={append:{start:"'+(",end:")+'",endencode:"||'').toString().encodeHTML()+'"},split:{start:"';out+=(",end:");out+='",endencode:"||'').toString().encodeHTML();out+='"}},doT={template:function(a,s,l){var i,c,d,u=(s=s||doT.templateSettings).append?r.append:r.split,h=0;a=s.use||s.define?t(s,a,l||{}):a,a=("var out='"+(s.strip?a.replace(/(^|\r|\n)\t* +| +\t*(\r|\n|$)/g," ").replace(/\r|\n|\t|\/\*[\s\S]*?\*\//g,""):a).replace(/'|\\/g,"\\$&").replace(s.interpolate||o,(function(e,t){return u.start+n(t)+u.end})).replace(s.encode||o,(function(e,t){return c=!0,u.start+n(t)+u.endencode})).replace(s.conditional||o,(function(e,t,a){return t?a?"';}else if("+n(a)+"){out+='":"';}else{out+='":a?"';if("+n(a)+"){out+='":"';}out+='"})).replace(s.iterate||o,(function(e,t,a,i){return t?(h+=1,d=i||"i"+h,t=n(t),"';var arr"+h+"="+t+";if(arr"+h+"){var "+a+","+d+"=-1,l"+h+"=arr"+h+".length-1;while("+d+"<l"+h+"){"+a+"=arr"+h+"["+d+"+=1];out+='"):"';} } out+='"})).replace(s.evaluate||o,(function(e,t){return"';"+n(t)+"out+='"}))+"';return out;").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r").replace(/(\s|;|\}|^|\{)out\+='';/g,"$1").replace(/\+''/g,"").replace(/(\s|;|\}|^|\{)out\+=''\+/g,"$1out+="),c&&s.selfcontained&&(a="String.prototype.encodeHTML=("+e.toString()+"());"+a);try{return new Function(s.varname,a)}catch(e){throw"undefined"!=typeof console&&console.log("Could not create a template function: "+a),e}},compile:function(e,t){var i;return doT.template(e,null,t)},templateSettings:{evaluate:{},interpolate:{},encode:{},use:{},define:{},conditional:{},iterate:{},varname:"it",strip:!0,append:!0,selfcontained:!1}},pageModule=function(Kg){function isScrollBot(){var scrollTop;return(document.documentElement.scrollTop||document.body.scrollTop)+window.screen.height>=document.body.clientHeight-60}function pagecallBack(json){Kg.$("#panelSongsList")[0].innerHTML+=doT.compile(Kg.$("#panelSongsListTmpl")[0].innerHTML)(json.data.info),playerModule.addAllSongs()}function getList(){var totalPage=parseInt(gbParams.totalPage,10);if(gbParams.curPage>=totalPage)return showHideUI.hide("ploading"),showHideUI.show("ploadingDone"),!1;showHideUI.show("ploading"),getBaseInfo(1058,(function(bInfo){window.infSign({appid:1058,dfid:bInfo.dfid,mid:bInfo.mid,uuid:bInfo.mid,token:bInfo.token?bInfo.token:"",userid:bInfo.userid||"0",keyword:decodeURIComponent(Kg.$("#keyword").val()),page:++gbParams.curPage,pagesize:gbParams.pagesize,showtype:1},null,{useH5:!0,postType:"json",callback:function(spa){var obj2QueryStr=function(a){var arr=[];for(var i in a)arr.push(i+"="+a[i]);return arr.join("&")};$.ajax({type:"get",url:"https://complexsearch.kugou.com/v3/search/song",data:JSON.stringify(spa),success:function(res){"string"==typeof res&&(res=JSON.parse(res)),0==res.error_code&&1==res.status&&res.data[0]&&pagecallBack(res)},error:function(){showHideUI.hide("ploading")}})}})}))}function init(){var isBot;isScrollBot()&&getList()}return{init:init}}(Kg),searchModule=function(Kg){var url={hotSearchUrl:"https:"==document.location.protocol?"https://mobiles.kugou.com/api/v3/search/hot":"http://mobilecdn.kugou.com/api/v3/search/hot",searchUrl:"https:"==document.location.protocol?"https://mobiles.kugou.com/api/v3/search/song":"http://mobilecdn.kugou.com/api/v3/search/song"};function hotSearchCallback(res){if(res&&1==res.status){var data=res.data.list,html=[];Kg.$("#hotSearchList")[0].innerHTML+=doT.compile(Kg.$("#hotSearchListTmpl")[0].innerHTML)(data),showHideUI.hide("loading")}}function getHotSearch(){showHideUI.show("loading"),Kg.Ajax({docType:"jsonp",method:"get",url:url.hotSearchUrl,callbackFuncName:"",args:{format:"jsonp",plat:0,count:gbParams.pagesize},callback:function(res){hotSearchCallback(res)},error:function(){showHideUI.hide("loading")}})}function searchCallback(res){Kg.$("#searchResult")[0].innerHTML="",playerModule.resetCache(),showHideUI.hide("hotSearch"),showHideUI.show("searchResult"),showHideUI.hide("loading"),showHideUI.hide("ploading"),showHideUI.hide("ploadingDone"),res&&1==res.status&&(Kg.$("#searchResult")[0].innerHTML+=doT.compile(Kg.$("#searchResultTmpl")[0].innerHTML)(res.data),showHideUI.hide("hotSearch"),showHideUI.show("searchResult"),res.data.total>0?(playerModule.addAllSongs(),gbParams.totalPage=Math.ceil(res.data.total/gbParams.pagesize),Kg.$("body")[0].style.background="#fff"):Kg.$("body")[0].style.background="#f5f5f5")}function toSearch(keyword){phpLogClick(5533),showHideUI.show("loading"),getBaseInfo(1058,(function(bInfo){window.infSign({appid:1058,dfid:bInfo.dfid,mid:bInfo.mid,uuid:bInfo.mid,token:bInfo.token?bInfo.token:"",userid:bInfo.userid||"0",keyword:decodeURIComponent(Kg.$("#keyword").val()),page:++gbParams.curPage,pagesize:gbParams.pagesize},null,{useH5:!0,postType:"json",callback:function(spa){$.ajax({type:"get",url:"https://gateway.kugou.com/complexsearch/v3/search/song",data:spa,success:function(res){"string"==typeof res&&(res=JSON.parse(res)),0==res.error_code&&1==res.status?($(".empty-search-result").hide(),renderList(res.data.lists)):$(".empty-search-result").show()},error:function(){$(".empty-search-result").show(),showHideUI.hide("ploading")}})}})}))}gbParams.pagesize=30;var renderList=function(arr){if(!arr.length)return $(".empty-search-result").hide(),$(".search-result").html(""),void setTimeout((function(){$(".empty-search-result").show()}),50);for(var eleStr='\n\t\t\t\t<div class="search-result-hd"> 网页仅展示部分内容，请移步酷狗客户端查看完整内容 </div>\n\t\t\t\t<div class="panel-songslist" id="panelSongsList"> \n\t\t',i=0;i<arr.length;i++)eleStr+='\n\t\t\t\t\t\t<a class="panel-songslist-item " href="https://m.kugou.com/mixsong/'+arr[i].EMixSongID+'.html"> \n\t\t\t\t\t\t\t<div class="panel-songs-item-name btn_play">\n\t\t\t\t\t\t\t<span>'+arr[i].FileName+"</span> \n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</a>\t\n\t\t\t\t\t";eleStr+='</div>\n\t\t\t\t<div class="ploading-done " id="ploadingDone" style="display:block">更多好歌，尽在酷狗 <span class="m_footer1_a1 download-app _homeFootBtn" id="openAppBtn" onclick="_hmt.push([\'_trackEvent\',\'listsoftware\', \'listdownload\', \'listkugou\'])">打开APP</span></div>\n\n\t\t',$(".search-result").html(eleStr)};function hotSearch(o){var keyword=Kg.$(o.el).html();""!==keyword&&(Kg.$("#keyword").val(keyword),Kg.$("#searchBtn").removeClass("search-disabled-btn"),Kg.$("#searchBtn")[0].removeAttribute("disabled"),gbParams.curPage=0,toSearch(keyword))}function search(o){var keyword="";return keyword=(keyword=o&&o.keyword?o.keyword:Kg.$("#keyword").val()).trim(),o.type&&""===keyword&&(Kg.$("#keyword").val(""),alert("关键字不能为空")),""!==(keyword=keyword.trim())&&toSearch(keyword),!1}function init(){var keyword=Kg.request.search("keyword");keyword&&(Kg.$("#keyword").val(decodeURIComponent(keyword)),Kg.$("#searchBtn").removeClass("search-disabled-btn"),Kg.$("#searchBtn")[0].removeAttribute("disabled"),toSearch(keyword)),Kg.$("#searchBtn").addEvent("click",(function(e){e.preventDefault(),gbParams.curPage=0,search({type:!0})})),Kg.$("#keyword").addEvent("focus",(function(e){Kg.$("#searchBtn").removeClass("search-disabled-btn"),Kg.$("#searchBtn")[0].removeAttribute("disabled")})),Kg.$("#keyword").addEvent("blur",(function(e){""==Kg.$(this).val()&&(Kg.$("#searchBtn").addClass("search-disabled-btn"),Kg.$("#searchBtn")[0].setAttribute("disabled","disabled"))}))}return{hotSearch:hotSearch,init:init}}(Kg);function pageInit(){searchModule.init(),$(document).on("click","#goback",(function(){window.history.back()}))}pageInit();